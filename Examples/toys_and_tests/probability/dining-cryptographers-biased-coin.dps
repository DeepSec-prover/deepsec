const true,false.
free c1,c2,c3,c4,c5,c6 [private].
free a1, a2, a3.

reduc xor(false, false, false) -> false;
      xor(false, false, true) -> true;
      xor(false, true, false) -> true;
      xor(false, true, true) -> false;
      xor(true, false, false) -> true;
      xor(true, false, true) -> false;
      xor(true, true, false) -> false;
      xor(true, true, true) -> true.
      
      
let O(cl,cr) =
// coin tossing oracle:
// sends the result of a biased coin toss on channels cl and cr
    ( out(cl,true) | out(cr,true) ) +{0.4}
    ( out(cl,false) | out(cr,false) ).

let A(cl,cr,c,b) =
// agent process: receives coin toss results on channels cl and cr;
// outputs on channel c the xor of toin cosses and secret bit b
    in (cl,xl); in (cr, xr);
    out(c, xor(xl,xr,b)).
    

let DC(b1,b2,b3) =
    	O(c1,c5) | O(c2,c4) | O(c3,c6) |
      	A(c1,c2,a1,b1) | A(c3,c4,a2,b2) | A(c5,c6,a3,b3).
      	
query trace_equiv(DC(true,false,false),DC(false,false,true)).
