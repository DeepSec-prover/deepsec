// small instance of BAC

fun mac/2.

free c,d.
const ok, error.

let reader(k) =
  in(d,n_t);
  out(d,mac(n_t,k)).

let passport(k) =
  in(c,x);
  new n_t;
  out(c,n_t);
  in(c,y);
  if y = mac(n_t,k) then out(c,ok)
  else out(c,error).


let system1 =
  new k; passport(k) | new k; reader(k).

let system2 =
  new k; (passport(k) | reader(k)).

query session_equiv(system1,system2). // non-equivalent
