free a,b,c.
const alpha.
fun f/1.
fun h/2.

let P = in(a,x); (in(b,y);out(c,c) | in(c,z);out(c,c)). // reflexivity raises Not_found
let R = in(c,x); (in(c,y); out(c,x) | in(c,z); in(c,zz)). // reflexivity ok
let loli = in(c,x); in(c,y); out(c,h(x,y)). // instant, even with !^6 (11 min deepsec)
let bangloli = !^17 loli.
let S1 = in(c,x); out(c,x).
let S2 = in(c,x); out(c,a).
let T1 = in(c,x).
let T2 = if a = a then 0 else in(c,x).
let U1 = out(a,a) | out(b,b).
let U2 = out(a,a) | out(b,a). // bad attack trace found with U1

query sess_equiv(U1, U2).
